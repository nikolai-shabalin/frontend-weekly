---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

interface MonthData {
  month: string;
  issues: number;
  articles: number;
}

interface StatsData {
  totalIssues: number;
  totalArticles: number;
  averageArticlesPerIssue: number;
  byMonth: Record<string, MonthData>;
  byCategory: Record<string, number>;
  mostActiveMonth: string;
  year: number;
}

const stats: StatsData = {
  "totalIssues": 30,
  "totalArticles": 1407,
  "averageArticlesPerIssue": 46.9,
  "byMonth": {
    "2025-06": {
      "month": "–∏—é–Ω—å 2025 –≥.",
      "issues": 5,
      "articles": 289
    },
    "2025-07": {
      "month": "–∏—é–ª—å 2025 –≥.",
      "issues": 4,
      "articles": 208
    },
    "2025-08": {
      "month": "–∞–≤–≥—É—Å—Ç 2025 –≥.",
      "issues": 4,
      "articles": 138
    },
    "2025-09": {
      "month": "—Å–µ–Ω—Ç—è–±—Ä—å 2025 –≥.",
      "issues": 5,
      "articles": 202
    },
    "2025-10": {
      "month": "–æ–∫—Ç—è–±—Ä—å 2025 –≥.",
      "issues": 4,
      "articles": 197
    },
    "2025-11": {
      "month": "–Ω–æ—è–±—Ä—å 2025 –≥.",
      "issues": 4,
      "articles": 180
    },
    "2025-12": {
      "month": "–¥–µ–∫–∞–±—Ä—å 2025 –≥.",
      "issues": 4,
      "articles": 193
    }
  },
  "byCategory": {
    "HTML –∏ –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞": 93,
    "CSS –∏ –¥–∏–∑–∞–π–Ω": 178,
    "React –∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏": 170,
    "–í–∏–¥–µ–æ –∏ —Å—Ç–∞—Ç—å–∏": 37,
    "–†–∞–∑–Ω–æ–µ": 54,
    "JavaScript": 107,
    "SEO –∏ –ø–æ–∏—Å–∫": 2,
    "–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ —Ä–µ–ª–∏–∑—ã": 7,
    "–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏": 528,
    "–ì–ª–∞–≤–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏": 7,
    "–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∏ UX": 1,
    "–û–±—É—á–µ–Ω–∏–µ –∏ —Å—Ç–∞—Ç—å–∏": 31,
    "–ú–Ω–µ–Ω–∏—è –∏ –æ–±–∑–æ—Ä—ã": 3,
    "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å": 2,
    "–í–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ": 1,
    "–û–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å WWDC 2025": 4,
    "TypeScript": 10,
    "–ù–µ–¥–∞–≤–Ω—è—è —Å–µ—Ä–∏—è –ø–æ—Å—Ç–æ–≤ –≤ –±–ª–æ–≥–µ –î—ç–Ω–∞ –ê–±—Ä–∞–º–æ–≤–∞": 4,
    "Node.js": 148,
    "–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ": 0,
    "–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ API": 0,
    "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –¥–æ—Å—Ç—É–ø": 2,
    "Angular": 1,
    "–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å (A11Y)": 2,
    "–ò–ò": 11,
    "DevTools –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å": 0,
    "–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å (A11y) –∏ UI-–ø–∞—Ç—Ç–µ—Ä–Ω—ã": 0,
    "–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ DevTools": 0,
    "–ê–¥–≤–µ–Ω—Ç-–∫–∞–ª–µ–Ω–¥–∞—Ä–∏ –¥–ª—è –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤": 4
  },
  "mostActiveMonth": "–∏—é–Ω—å 2025 –≥.",
  "year": 2025
};

// –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–µ–ª
function formatNumber(num: number): string {
  return new Intl.NumberFormat('ru-RU').format(num);
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–ø –∫–∞—Ç–µ–≥–æ—Ä–∏–π
function getTopCategories(categories: Record<string, number>): Array<{ name: string; count: number }> {
  return Object.entries(categories)
    .filter(([name, count]: [string, unknown]) => typeof count === 'number' && count > 0 && !name.includes('Ô∏è'))
    .sort((a, b) => (b[1] as number) - (a[1] as number))
    .slice(0, 10)
    .map(([name, count]) => ({ name, count: count as number }));
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
function getMaxValue(data: Record<string, MonthData>): number {
  return Math.max(...Object.values(data).map((d: MonthData | null) => d?.articles ?? 0));
}
---

<html lang="ru">
  <head>
    <BaseHead 
      title="–ò—Ç–æ–≥–∏ –¥–∞–π–¥–∂–µ—Å—Ç–∞ –∑–∞ 2025 –≥–æ–¥ | Frontend Weekly" 
      description="–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–≥–æ –¥–∞–π–¥–∂–µ—Å—Ç–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥-–Ω–æ–≤–æ—Å—Ç–µ–π –∑–∞ 2025 –≥–æ–¥: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–ø—É—Å–∫–æ–≤, —Å—Ç–∞—Ç–µ–π, –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ" 
    />
    <style>
      :root {
        --als-black: #000000;
        --als-white: #ffffff;
        --als-gray-light: #f5f5f5;
        --als-gray: #999999;
        --als-red: #ff0000;
        --grid-border: 1px solid #000000;
        --font-mono: 'JetBrains Mono', 'Monaco', 'Courier New', monospace;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background-color: var(--als-white);
        color: var(--als-black);
        line-height: 1.2;
        -webkit-font-smoothing: antialiased;
      }

      .als-layout {
        max-width: 100%;
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
      }

      /* Grid Header */
      .als-hero {
        border-bottom: var(--grid-border);
        padding: 40px 20px;
        display: grid;
        grid-template-columns: 1fr auto;
        align-items: end;
        gap: 20px;
      }

      .als-hero-title {
        font-size: clamp(4rem, 15vw, 12rem);
        font-weight: 900;
        line-height: 0.8;
        letter-spacing: -0.05em;
        text-transform: uppercase;
      }

      .als-hero-tag {
        background: var(--als-red);
        color: white;
        padding: 4px 12px;
        font-size: 1.2rem;
        font-weight: 700;
        text-transform: uppercase;
        height: min-content;
      }

      .als-hero-subtitle {
        grid-column: 1 / -1;
        font-size: 1.5rem;
        font-weight: 400;
        max-width: 600px;
        margin-top: 20px;
        text-transform: uppercase;
      }

      /* Stats Grid */
      .als-stats-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        border-bottom: var(--grid-border);
      }

      .als-stat-item {
        padding: 30px 20px;
        border-right: var(--grid-border);
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        min-height: 200px;
      }

      .als-stat-item:last-child {
        border-right: none;
      }

      .als-stat-label {
        font-size: 0.9rem;
        font-weight: 700;
        text-transform: uppercase;
        color: var(--als-gray);
        margin-bottom: 20px;
      }

      .als-stat-number {
        font-size: clamp(2rem, 5vw, 4.5rem);
        font-weight: 900;
        line-height: 1;
        letter-spacing: -0.03em;
      }

      /* Section */
      .als-section {
        border-bottom: var(--grid-border);
      }

      .als-section-header {
        padding: 20px;
        background: var(--als-black);
        color: var(--als-white);
        font-size: 1rem;
        font-weight: 700;
        text-transform: uppercase;
        display: flex;
        justify-content: space-between;
      }

      /* Matrix / Data Section */
      .als-months-table {
        width: 100%;
        border-collapse: collapse;
      }

      .als-months-table tr {
        border-bottom: 1px solid #eeeeee;
      }

      .als-months-table tr:last-child {
        border-bottom: none;
      }

      .als-months-table td {
        padding: 15px 20px;
        vertical-align: middle;
      }

      .als-month-num {
        font-family: var(--font-mono);
        color: var(--als-gray);
        width: 40px;
      }

      .als-month-name {
        font-weight: 700;
        text-transform: uppercase;
        width: 200px;
      }

      .als-month-bar-cell {
        flex-grow: 1;
      }

      .als-bar-bg {
        height: 8px;
        background: var(--als-gray-light);
        width: 100%;
        position: relative;
      }

      .als-bar-fill {
        height: 100%;
        background: var(--als-black);
        position: absolute;
        top: 0;
        left: 0;
      }

      .als-bar-fill.active {
        background: var(--als-red);
      }

      .als-month-val {
        font-family: var(--font-mono);
        text-align: right;
        width: 100px;
        font-weight: 700;
      }

      /* Categories */
      .als-categories {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      }

      .als-category-item {
        padding: 20px;
        border-right: 1px solid #eeeeee;
        border-bottom: 1px solid #eeeeee;
        display: flex;
        justify-content: space-between;
        align-items: baseline;
      }

      .als-category-name {
        font-weight: 400;
        text-transform: uppercase;
        font-size: 0.95rem;
      }

      .als-category-count {
        font-family: var(--font-mono);
        font-weight: 700;
        color: var(--als-red);
      }

      /* Conclusion */
      .als-conclusion {
        padding: 60px 20px;
        background: var(--als-gray-light);
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 40px;
      }

      .als-conclusion-title {
        font-size: 3rem;
        font-weight: 900;
        text-transform: uppercase;
        line-height: 0.9;
      }

      .als-conclusion-text {
        font-size: 1.1rem;
        color: #333;
      }

      .als-conclusion-text p {
        margin-bottom: 1.5rem;
      }

      .als-holiday-note {
        margin-top: 40px;
        padding: 20px;
        border: 2px solid var(--als-red);
        display: inline-block;
      }

      .als-holiday-title {
        color: var(--als-red);
        font-weight: 900;
        text-transform: uppercase;
        margin-bottom: 10px;
        display: block;
      }

      /* Mobile */
      @media (max-width: 800px) {
        .als-stats-grid {
          grid-template-columns: 1fr 1fr;
        }
        .als-stat-item:nth-child(2) {
          border-right: none;
        }
        .als-stat-item:nth-child(even) {
          border-right: none;
        }
        .als-conclusion {
          grid-template-columns: 1fr;
        }
        .als-month-name {
          width: 100px;
        }
      }

      @media (max-width: 500px) {
        .als-stats-grid {
          grid-template-columns: 1fr;
        }
        .als-stat-item {
          border-right: none;
        }
        .als-month-bar-cell {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <Header />
    <main class="als-layout">
      {stats ? (
        <>
          <div class="als-hero">
            <h1 class="als-hero-title">2025</h1>
            <div class="als-hero-tag">–ò—Ç–æ–≥–∏</div>
            <p class="als-hero-subtitle">
              frontend weekly: –≥–æ–¥–æ–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á–µ—Ç
            </p>
          </div>

          <div class="als-stats-grid">
            <div class="als-stat-item">
              <span class="als-stat-label">–í—ã–ø—É—Å–∫–æ–≤ –∑–∞–ø–∏—Å–∞–Ω–æ</span>
              <span class="als-stat-number">{formatNumber(stats.totalIssues)}</span>
            </div>
            <div class="als-stat-item">
              <span class="als-stat-label">–í—Å–µ–≥–æ —Å—Ç–∞—Ç–µ–π</span>
              <span class="als-stat-number">{formatNumber(stats.totalArticles)}</span>
            </div>
            <div class="als-stat-item">
              <span class="als-stat-label">–í —Å—Ä–µ–¥–Ω–µ–º –Ω–∞ –≤—ã–ø—É—Å–∫</span>
              <span class="als-stat-number">{stats.averageArticlesPerIssue}</span>
            </div>
            <div class="als-stat-item">
              <span class="als-stat-label">–¢–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–µ–≥–æ–≤</span>
               <span class="als-stat-number">{Object.keys(stats.byCategory).filter((c: string) => (stats.byCategory[c] ?? 0) > 0).length}</span>
            </div>
          </div>

          <section class="als-section">
            <div class="als-section-header">
              <span>–ú–∞—Ç—Ä–∏—Ü–∞ –º–µ—Å—è—á–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</span>
              <span>–ú–µ—Ç—Ä–∏–∫–∞: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–∞—Ç–µ–π</span>
            </div>
            <table class="als-months-table">
              {Object.entries(stats.byMonth)
                .sort((a, b) => a[0].localeCompare(b[0]))
                .map(([key, data], index) => {
                  const maxArticles = getMaxValue(stats.byMonth);
                  const percentage = (data.articles / maxArticles) * 100;
                  const isMostActive = stats.mostActiveMonth === data.month;
                  return (
                    <tr>
                      <td class="als-month-num">{(index + 1).toString().padStart(2, '0')}</td>
                      <td class="als-month-name">{data.month}</td>
                      <td class="als-month-bar-cell">
                        <div class="als-bar-bg">
                          <div class="als-bar-fill" style={`width: ${percentage}%; background: ${isMostActive ? 'var(--als-red)' : 'var(--als-black)'}`}></div>
                        </div>
                      </td>
                      <td class="als-month-val">{data.articles}</td>
                    </tr>
                  );
                })}
            </table>
          </section>

          <section class="als-section">
            <div class="als-section-header">
              <span>–¢–æ–ø –∫–∞—Ç–µ–≥–æ—Ä–∏–π</span>
              <span>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ</span>
            </div>
            <div class="als-categories">
              {getTopCategories(stats.byCategory).map(({ name, count }) => (
                <div class="als-category-item">
                  <span class="als-category-name">{name}</span>
                  <span class="als-category-count">{formatNumber(count)}</span>
                </div>
              ))}
            </div>
          </section>

          <section class="als-conclusion">
            <div>
              <h2 class="als-conclusion-title">–î–æ –≤—Å—Ç—Ä–µ—á–∏<br/>–≤ –¥–≤–µ —Ç—ã—Å—è—á–∏<br/>–¥–≤–∞–¥—Ü–∞—Ç—å<br/>—à–µ—Å—Ç–æ–º.</h2>
              
              <div class="als-holiday-note">
                <span class="als-holiday-title">–°—Ç–∞—Ç—É—Å: –í –æ—Ç–ø—É—Å–∫–µ</span>
                <p>–í—ã–ø—É—Å–∫–∏ –¥–∞–π–¥–∂–µ—Å—Ç–∞ —É—Ö–æ–¥—è—Ç –Ω–∞ –Ω–æ–≤–æ–≥–æ–¥–Ω–∏–µ –∫–∞–Ω–∏–∫—É–ª—ã. –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –≤ —è–Ω–≤–∞—Ä–µ.</p>
              </div>
            </div>
            
            <div class="als-conclusion-text">
              <p>
                –§—Ä–æ–Ω—Ç–µ–Ω–¥-—Å–æ–æ–±—â–µ—Å—Ç–≤—É: üéâ
              </p>
              <p>
                –ï—â–µ –æ–¥–∏–Ω –≥–æ–¥ —Å—Ç—Ä–µ–º–∏—Ç–µ–ª—å–Ω–æ–π —ç–≤–æ–ª—é—Ü–∏–∏ –ø–æ–∑–∞–¥–∏. –ú—ã –±–ª–∞–≥–æ–¥–∞—Ä–Ω—ã –∑–∞ –≤–∞—à–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ –≤—Å–µ–≥–æ 2025 –≥–æ–¥–∞. 
              </p>
              <p>
                –ù–∞—à–∞ —Ü–µ–ª—å –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω–æ–π: –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞—Ç—å —à—É–º, —á—Ç–æ–±—ã –¥–æ–Ω–µ—Å—Ç–∏ –¥–æ –≤–∞—Å —Å–∏–≥–Ω–∞–ª. –ù–∞–¥–µ–µ–º—Å—è, —ç—Ç–∏ –¥–∞–π–¥–∂–µ—Å—Ç—ã —Å–ª—É–∂–∏–ª–∏ –Ω–∞–¥–µ–∂–Ω—ã–º –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º –≤ –æ–≥—Ä–æ–º–Ω–æ–º –º–æ—Ä–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.
              </p>
              <p>
                –í 2026 –≥–æ–¥—É –∂–µ–ª–∞–µ–º –≤–∞–º —É—Å—Ç–æ–π—á–∏–≤—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞–Ω—Ç–∞–π–º–æ–≤ –∏ –∑–Ω–∞—á–∏–º—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤. –ü—É—Å—Ç—å –≤–∞—à–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –±—É–¥—É—Ç —Å—Ç–∞–±–∏–ª—å–Ω—ã–º–∏, –∞ –≤—Ä–µ–º—è —Å–±–æ—Ä–∫–∏ ‚Äî –∫–æ—Ä–æ—Ç–∫–∏–º. üöÄ
              </p>
            </div>
          </section>
        </>
      ) : (
        <div class="error-state">
          <h1 class="error-title">–î–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</h1>
          <p class="error-text">
            –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –¥–≤–∏–∂–æ–∫ –≤–µ—Ä–Ω—É–ª null.
          </p>
          <div class="error-code">pnpm run analyze:digest</div>
        </div>
      )}
    </main>
    <Footer />
  </body>
</html>
